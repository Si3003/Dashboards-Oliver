const files = {
    etp: [
        {
            name: 'ETPSuite_PH_98A',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=31e1cd1d%2D6d8e%2D4758%2D9a2e%2Ddc7fb00e76a7'
        },
        {
            name: 'ETPSuite_ID_98A',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=c86a905e%2Dd7fb%2D4723%2D954d%2D0c851a86582a'
        }
    ],
    store: [
        {
            name: 'Environment Java8',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=de50eae1%2D3a3b%2D4a9b%2Daf68%2D4d294add94ae'
        },
        {
            name: '7z920-x64',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=a0a597d5%2D56c5%2D44ce%2D9ff3%2D98c96ad8cb50'
        },
        {
            name: 'AdbeRdr90_en_US',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=3c5034f2%2D64af%2D457e%2D8e2c%2D9bb56aa37399'
        },
        {
            name: 'TeamViewer_Setup_x64',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=61083652%2D7844%2D4123%2Dbc97%2D4b8f710cf22a'
        },
        {
            name: 'Crytal Report',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=7b7ef360%2Dcabc%2D486c%2D85a2%2D03beade15f69'
        },
        {
            name: 'Star_BSC10_CD_V2.0.0',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=ab73382f%2D27b9%2D496e%2Da6cb%2D4ababaf39890'
        },
        {
            name: 'SQL 2022',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=90e48b67%2D7530%2D45b8%2Dbd06%2D9de6789b9f7c'
        },
        {
            name: 'SourceParallels',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=7bd4f889%2D076e%2D4d97%2D861a%2D83ff0b6abfa3'
        },
        {
            name: 'CrowdStrike',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=993657ff%2D2a69%2D4892%2Da606%2D2c40d161c205'
        },
        {
            name: 'ETPRegedit_Store',
            url: 'https://mapcoid-my.sharepoint.com/:u:/r/personal/oliver_panjaitan_map_co_id/Documents/300393/STORE_INDONESIA/Source_Store/ETPRegedit_StoreCode.reg?csf=1&web=1&e=CQ8Tqf'
        },
        {
            name: 'ICC V7.7.apk',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=b1f31dc3%2Da100%2D4bf3%2D8d41%2Dab3e48322196'
        },
        {
            name: 'EncryptDecryptR10',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=157e1190%2D098c%2D4057%2D9b9c%2Dd4c841881d12'
        }
    ],
    databaseindo: [
        {
            name: 'DatabaseSuite_X1.zip',
            url: 'https://example.com/path/to/DatabaseSuite_X1.zip'
        },
        {
            name: 'DatabaseSuite_Y2.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Y2.zip'
        },
        {
            name: 'DatabaseSuite_Z3.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Z3.zip'
        }
    ],
    databaseph: [
        {
            name: 'DatabaseSuite_X1.zip',
            url: 'https://example.com/path/to/DatabaseSuite_X1.zip'
        },
        {
            name: 'DatabaseSuite_Y2.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Y2.zip'
        },
        {
            name: 'DatabaseSuite_Z3.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Z3.zip'
        }
    ],
    databasevn: [
        {
            name: 'DatabaseSuite_X1.zip',
            url: 'https://example.com/path/to/DatabaseSuite_X1.zip'
        },
        {
            name: 'DatabaseSuite_Y2.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Y2.zip'
        },
        {
            name: 'DatabaseSuite_Z3.zip',
            url: 'https://example.com/path/to/DatabaseSuite_Z3.zip'
        }
    ],
     patch: [
        {
            name: 'PATCHING 108',
            url: 'https://southeastasia1-mediap.svc.ms/transform/zip?cs=fFNQTw'
        }
    ],
    howto: [
        {
            name: 'SETUP EDS VIETNAM',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=0aa3919d%2D77bd%2D4683%2D8675%2D952c5db3d9fb'
        },
        {
            name: 'Setup Windows in iMac or Macbook M1,M2',
            url: 'https://mapcoid-my.sharepoint.com/personal/oliver_panjaitan_map_co_id/_layouts/15/download.aspx?UniqueId=603bc706%2D5be5%2D4f14%2Da39e%2Dd43c7e0daf56'
        }
    ]
};

function searchFiles() {
    const input = document.getElementById('searchInput').value.toUpperCase();
    const fileList = document.getElementById('file-list');
    const rows = fileList.getElementsByTagName('tr');

    for (let i = 0; i < rows.length; i++) {
        const fileCell = rows[i].getElementsByTagName('td')[0];
        if (fileCell) {
            const fileName = fileCell.textContent || fileCell.innerText;
            if (fileName.toUpperCase().indexOf(input) > -1) {
                rows[i].style.display = '';
            } else {
                rows[i].style.display = 'none';
            }
        }
    }
}

function loadFiles(category, button) {
    const fileList = document.getElementById('file-list');
    fileList.innerHTML = '';
    files[category].forEach(file => {
        const row = document.createElement('tr');
        const fileCell = document.createElement('td');
        const actionCell = document.createElement('td');
        const downloadLink = document.createElement('a');

        fileCell.textContent = file.name;
        downloadLink.textContent = 'DOWNLOAD';
        downloadLink.href = file.url;
        downloadLink.className = 'download-link action'; // Added 'action' class here
        downloadLink.download = file.name;
        downloadLink.onclick = () => {
            displayMessage(`Start downloading ${file.name}`);
        };

        actionCell.appendChild(downloadLink);
        row.appendChild(fileCell);
        row.appendChild(actionCell);
        fileList.appendChild(row);
    });

    const buttons = document.querySelectorAll('.button');
    buttons.forEach(btn => btn.classList.remove('active'));
    button.classList.add('active');
}

function displayMessage(msg) {
    const message = document.getElementById('message');
    message.textContent = msg;
    setTimeout(() => {
        message.textContent = '';
    }, 5000);
}

// Load default category
loadFiles('etp', document.querySelector('.source-etp'));
